# 쿼리실습 26~30

## 26. 제주도에 위치한 상영관을 좌석수가 많은 순서로 정렬하는 SQL문 작성 [ ORDER BY ]

```sql
SELECT *
FROM SCREEN
WHERE 1=1
AND SIDO = '제주도'
ORDER BY SEAT_COUNT DESC
```

## 27. 한국에서 개최되는 주요 축제가 개최된 도시의 상영관 수를 각각 조회하는 SQL문 [ IFNULL(), SUM(), CONCAT(), LEFT JOIN문, GROUP BY, 서브쿼리 ]

```sql
SELECT F.*
	, IFNULL(S.SCREEN_COUNT, 0) AS SCREEN_COUNT
FROM 
(
	SELECT 
	CONCAT(CITY, '시') AS CITY
	FROM FESTIVAL
	WHERE 1=1
	AND COUNTRY = '한국'
	AND IMPORTANT_FLAG = '예'
)F
LEFT JOIN 
(
	SELECT SIDO 
		, SUM(SCREEN_COUNT) AS SCREEN_COUNT
	FROM SCREEN
	GROUP BY SIDO
)S ON S.SIDO = F.CITY
```

## 28. 새로운 축제를 등록하기 위해서 CODE값의 최대값에 +1을 더한 신규 코드값을 가져오는 SQL문 작성 [ MAX() ]

```sql
SELECT IFNULL(MAX(CODE), 0) + 1
FROM FESTIVAL
```

## 29. 한국 배우중에서 이름과 영문이름이 존재하고, 생년월일 데이터가 정확한 배우의 전체개수와 이름순으로 20개 단위로 페이징 처리 하기위한 SQL문 작성 [ COUNT(), TRIM(), LENGTH(), STR_TO_DATE(), ROW_NUMBER(), ORDER BY, LIMIT ]

```sql
SELECT ROW_NUMBER () OVER (ORDER BY A.NAME) AS RANKING 
	, A.*
FROM ACTOR A
WHERE 1=1
AND A.COUNTRY = '한국'
AND A.DOMAIN = '배우'
AND LENGTH(TRIM(A.BIRTH)) = 10
AND STR_TO_DATE(A.BIRTH, '%Y-%m-%d') IS NOT NULL
AND A.NAME IS NOT NULL AND TRIM(A.NAME) <> ''
AND A.ENG_NAME IS NOT NULL AND TRIM(A.NAME) <> ''
ORDER BY A.NAME
LIMIT 10, 20
```

## 30. 영화인이 속한 국가와 축제가 진행되는 국가 모두를 표시하는 SQL문 작성 [ DISTINCT, UNION, IS NOT NULL, TRIM() ]

```sql
SELECT DISTINCT COUNTRY 
FROM ACTOR
WHERE COUNTRY IS NOT NULL AND TRIM(COUNTRY) <> ''
UNION
SELECT DISTINCT COUNTRY 
FROM FESTIVAL
WHERE COUNTRY IS NOT NULL AND TRIM(COUNTRY) <> ''
```